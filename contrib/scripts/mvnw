#!/usr/bin/env bash
# mvnw wrapper to inject secrets env
# used in deploy script
# ref: https://jreleaser.org/guide/latest/examples/maven/maven-central.html#_maven

set -TCEeuo pipefail

export JRELEASER_MAVENCENTRAL_USERNAME
JRELEASER_MAVENCENTRAL_USERNAME=$(pass combostrap/sonatype/username)

export JRELEASER_MAVENCENTRAL_PASSWORD
JRELEASER_MAVENCENTRAL_PASSWORD=$(pass combostrap/sonatype/password)

export JRELEASER_GPG_PASSPHRASE
JRELEASER_GPG_PASSPHRASE=$(pass combostrap/gpg/software-signing-key-passphrase)

export JRELEASER_GITHUB_TOKEN
JRELEASER_GITHUB_TOKEN=$(pass combostrap/github/release-token)

# For snapshot
export JRELEASER_NEXUS2_USERNAME="${JRELEASER_MAVENCENTRAL_USERNAME}"
export JRELEASER_NEXUS2_PASSWORD="${JRELEASER_MAVENCENTRAL_PASSWORD}"

# Run
"$PROJECT_ROOT/mvnw" "$@"